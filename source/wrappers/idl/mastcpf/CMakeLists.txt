cmake_minimum_required( VERSION 2.8 )

find_package( PostgreSQL REQUIRED )
find_package( IDL REQUIRED )

set( LIB_NAME mastcpf )

set( SRC_FILES mastCPF.c )

include_directories(
  ${CMAKE_SOURCE_DIR}/source
  ${IDL_INCLUDES}
  ${PostgreSQL_INCLUDE_DIRS}
)

add_library( ${LIB_NAME} SHARED ${SRC_FILES} )

target_link_libraries( ${LIB_NAME} LINK_PRIVATE ${IDC_LIB_NAME}
 ${IDL_LIBRARIES} ${PostgreSQL_LIBRARIES} )

set_target_properties( ${LIB_NAME}
  PROPERTIES
    PREFIX ""
    OUTPUT_NAME mastCPF
    VERSION ${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR}.${PROJECT_VERSION_PATCH}
    SOVERSION ${PROJECT_VERSION_MAJOR}
)

install( TARGETS ${LIB_NAME}
  DESTINATION dlm
)

set( INSTALL_FILES
  mastCPF.dlm
)

install( FILES ${INSTALL_FILES}
  DESTINATION dlm )
